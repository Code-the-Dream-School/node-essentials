TODO: delete this file.

zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
nothing to commit, working tree clean
zeus@MacBook-Air-de-Jamie node-homework % npm install pg dotenv

added 34 packages, removed 2 packages, changed 6 packages, and audited 551 packages in 3s

102 packages are looking for funding
  run `npm fund` for details

1 high severity vulnerability

To address all issues, run:
  npm audit fix

Run `npm audit` for details.
zeus@MacBook-Air-de-Jamie node-homework % npm audit
# npm audit report

qs  <6.14.1
Severity: high
qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion - https://github.com/advisories/GHSA-6rw7-vpxm-498p
fix available via `npm audit fix`
node_modules/qs

1 high severity vulnerability

To address all issues, run:
  npm audit fix
zeus@MacBook-Air-de-Jamie node-homework % npm audit fix

changed 1 package, and audited 551 packages in 2s

102 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   package-lock.json
        modified:   package.json

no changes added to commit (use "git add" and/or "git commit -a")
zeus@MacBook-Air-de-Jamie node-homework % psql --version
psql (PostgreSQL) 14.20 (Homebrew)
zeus@MacBook-Air-de-Jamie node-homework % brew services list
✔︎ JSON API cask_tap_migrations.jws.json                                                                                                                                                                                            [Downloaded    2.4KB/  2.4KB]
✔︎ JSON API cask.jws.json                                                                                                                                                                                                           [Downloaded   15.3MB/ 15.3MB]
✔︎ JSON API formula.jws.json                                                                                                                                                                                                        [Downloaded   32.0MB/ 32.0MB]
✔︎ JSON API formula_tap_migrations.jws.json                                                                                                                                                                                         [Downloaded    1.9KB/  1.9KB]
Name          Status  User File
postgresql@14 started zeus ~/Library/LaunchAgents/homebrew.mxcl.postgresql@14.plist
zeus@MacBook-Air-de-Jamie node-homework % brew services start postgresql@14
Service `postgresql@14` already started, use `brew services restart postgresql@14` to restart.
zeus@MacBook-Air-de-Jamie node-homework % brew services list
Name          Status  User File
postgresql@14 started zeus ~/Library/LaunchAgents/homebrew.mxcl.postgresql@14.plist
zeus@MacBook-Air-de-Jamie node-homework % ls -l
total 440
-rw-r--r--    1 zeus  staff    1071 Dec 15 11:51 LICENSE
-rw-r--r--@   1 zeus  staff   14186 Dec 29 17:47 README.md
-rw-r--r--@   1 zeus  staff    2037 Jan 29 17:13 app.js
drwxr-xr-x   10 zeus  staff     320 Dec 15 11:51 assignment1
drwxr-xr-x    3 zeus  staff      96 Dec 15 11:51 assignment2
drwxr-xr-x    4 zeus  staff     128 Jan 29 17:13 assignment5
drwxr-xr-x    3 zeus  staff      96 Dec 15 11:51 class-utils
drwxr-xr-x@   4 zeus  staff     128 Jan 29 17:13 controllers
drwxr-xr-x    7 zeus  staff     224 Dec 15 11:51 csv
drwxr-xr-x@   3 zeus  staff      96 Jan 29 17:13 db
-rw-r--r--    1 zeus  staff     421 Dec 15 11:51 eslint.config.js
drwxr-xr-x    4 zeus  staff     128 Dec 15 11:51 lesson9TDD
-rw-r--r--    1 zeus  staff    5015 Dec 15 11:51 load-db.js
drwxr-xr-x@   5 zeus  staff     160 Jan 29 17:13 middleware
-rw-r--r--@   1 zeus  staff      60 Jan 29 17:13 node-homework.code-workspace
drwxr-xr-x  393 zeus  staff   12576 Jan 30 11:33 node_modules
-rw-r--r--@   1 zeus  staff  162994 Jan 30 11:33 package-lock.json
-rw-r--r--@   1 zeus  staff    1293 Jan 30 11:25 package.json
-rw-r--r--    1 zeus  staff       1 Dec 15 11:51 project-links.txt
drwxr-xr-x@   4 zeus  staff     128 Jan 29 17:13 routes
-rw-r--r--@   1 zeus  staff     682 Jan 29 17:13 schema.sql
-rw-r--r--    1 zeus  staff    2884 Dec 15 11:51 sqlcommand.js
drwxr-xr-x   14 zeus  staff     448 Jan 29 17:13 tdd
-rwxr-xr-x@   1 zeus  staff     184 Jan 29 17:13 tdd.sh
drwxr-xr-x@  11 zeus  staff     352 Jan 29 17:13 validation
drwxr-xr-x    6 zeus  staff     192 Dec 15 11:51 week-3-middleware
zeus@MacBook-Air-de-Jamie node-homework % psql "postgresql://node_homework_owner@localhost/tasklist?host=/tmp" -f schema.sql
psql:schema.sql:9: NOTICE:  relation "users" already exists, skipping
CREATE TABLE
psql:schema.sql:19: NOTICE:  relation "tasks" already exists, skipping
CREATE TABLE
zeus@MacBook-Air-de-Jamie node-homework % postgresql://node_homework_owner@localhost/testtasklist?host=/tmp
zeus@MacBook-Air-de-Jamie node-homework % psql "postgresql://node_homework_owner@localhost/testtasklist?host=/tmp" -f schema.sql
psql:schema.sql:9: NOTICE:  relation "users" already exists, skipping
CREATE TABLE
psql:schema.sql:19: NOTICE:  relation "tasks" already exists, skipping
CREATE TABLE
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   package-lock.json
        modified:   package.json

no changes added to commit (use "git add" and/or "git commit -a")
zeus@MacBook-Air-de-Jamie node-homework %
 *  History restored

zeus@MacBook-Air-de-Jamie node-homework % npm dev
Unknown command: "dev"


Did you mean this?
  npm run dev # run the "dev" package script
To see a list of supported npm commands, run:
  npm help
zeus@MacBook-Air-de-Jamie node-homework % npm run dev

> node-homework@1.0.0 dev
> nodemon app.js

[nodemon] 3.1.10
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,cjs,json
[nodemon] starting `node app.js`
Server is listening on port 3000...
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:43:15)"}
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:43:15)"}
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:43:15)"}
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:45:15)"}
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
global.user_id = 1
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:45:15)"}
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
auth middleware, global.user_id = undefined
auth middleware, global.user_id = 1
auth middleware, global.user_id = 1
global.user_id = 1
auth middleware, global.user_id = 1
global.user_id = 1
Internal server error:  DatabaseError {"name":"error","message":"null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint","stack":"error: null value in column \"is_completed\" of relation \"tasks\" violates not-null constraint\n    at /Users/zeus/Documents/development/node-homework/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async exports.create (/Users/zeus/Documents/development/node-homework/controllers/taskController.js:45:15)"}
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
auth middleware, global.user_id = undefined
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
auth middleware, global.user_id = 1
auth middleware, global.user_id = 1
global.user_id = 1
auth middleware, global.user_id = 1
global.user_id = 1
auth middleware, global.user_id = 1
[nodemon] restarting due to changes...
[nodemon] starting `node app.js`
Server is listening on port 3000...
auth middleware, global.user_id = undefined
auth middleware, global.user_id = undefined
auth middleware, global.user_id = 1
auth middleware, global.user_id = 1
auth middleware, global.user_id = 1
auth middleware, global.user_id = 1
^CShutting down gracefully...
HTTP server closed.
Exiting process...

zeus@MacBook-Air-de-Jamie node-homework % npm run tdd assignment5

> node-homework@1.0.0 tdd
> ./tdd.sh assignment5

[napi-postinstall@0.3.0] Trying to install package "@unrs/resolver-binding-darwin-arm64" using npm
● Validation Error:

  Module /Users/zeus/Documents/development/node-homework/node_modules/jest-circus/build/runner.js in the testRunner option was not found.
         <rootDir> is: /Users/zeus/Documents/development/node-homework

  Configuration Documentation:
  https://jestjs.io/docs/configuration

zeus@MacBook-Air-de-Jamie node-homework % npm run tdd assignment5b

> node-homework@1.0.0 tdd
> ./tdd.sh assignment5b

  console.log
    global.user_id = 4

      at log (controllers/taskController.js:33:10)

 PASS  tdd/assignment5b.test.js
  ✓ finds the user and task schemas (1 ms)
  test that database and tables exist
    ✓ connects to database (54 ms)
    ✓ clears the tasks table (1 ms)
    ✓ clears the users table (1 ms)
  testing logon, register, and logoff
    ✓ You can register a user. (68 ms)
    ✓ The user can be logged on (51 ms)
    ✓ returns the expected name. (1 ms)
    ✓ A logon attempt with a bad password returns a 401 (54 ms)
    ✓ You can't register again with the same email. (54 ms)
    ✓ You can register an additional user. (54 ms)
    ✓ You can logon as that new user. (51 ms)
    ✓ You can now logoff. (1 ms)
  testing task creation
    ✓ Logon before testing tasks (51 ms)
    ✓ If you have a valid user id, create() succeeds (res.statusCode should be 201). (19 ms)
    ✓ The object returned from the create() call has the expected title. (1 ms)
    ✓ The object has the right value for isCompleted.
  getting created tasks
    ✓ If you use user1's id, index returns a 200 statusCode. (3 ms)
    ✓ The returned JSON array has length 1.
    ✓ The title in the first array object is as expected. (1 ms)
    ✓ If get the list of tasks using the userId from user2, you get a 404. (1 ms)
    ✓ You can retrieve the first array object using the `show()` method of the controller. (2 ms)
  testing the update and delete of tasks.
    ✓ User1 can set the task to isCompleted: true. (2 ms)
    ✓ User2 can't do this. (1 ms)
    ✓ User2 can't delete this task. (1 ms)
    ✓ User1 can delete this task. (2 ms)
    ✓ Retrieving user1's tasks now returns a 404. (1 ms)
  user object validation tests
    ✓ doesn't permit a trivial password (1 ms)
    ✓ The user schema requires that an email be specified. (1 ms)
    ✓ The user schema does not accept an invalid email. (1 ms)
    ✓ The user schema requires a password. (1 ms)
    ✓ The user schema requires name. (1 ms)
    ✓ The name must be valid (3 to 30 characters). (1 ms)
    ✓ If validation is performed on a valid user object, error comes back falsy.
  task object validation test
    ✓ The task schema requires a title.
    ✓ If an isCompleted value is specified, it must be valid. (1 ms)
    ✓ If an isCompleted value is not specified but the rest of the object is valid, a default of false is provided by validation
    ✓ If `isCompleted` in the provided object has the value `true`, it remains `true` after validation. (1 ms)
  patchTask object validation test
    ✓ Test that the title is not required in this case.
    ✓ Test that if no value is provided for `isCompleted`, that this remains undefined in the returned value. (1 ms)

Test Suites: 1 passed, 1 total
Tests:       39 passed, 39 total
Snapshots:   0 total
Time:        1.005 s
Ran all test suites matching ^tdd/.*assignment5b.*\.test\.js.
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
        modified:   controllers/taskController.js
        modified:   package-lock.json
        modified:   package.json

zeus@MacBook-Air-de-Jamie node-homework % git add . && git commit -m "Prepare for assignment6 by completing assignment 5."
[assignment5 f46ca64] Prepare for assignment6 by completing assignment 5.
 3 files changed, 114 insertions(+), 100 deletions(-)
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
nothing to commit, working tree clean
zeus@MacBook-Air-de-Jamie node-homework % git push
fatal: The current branch assignment5 has no upstream branch.
To push the current branch and set the remote as upstream, use

    git push --set-upstream origin assignment5

To have this happen automatically for branches without a tracking
upstream, see 'push.autoSetupRemote' in 'git help config'.

zeus@MacBook-Air-de-Jamie node-homework % git push --set-upstream origin assignment5
Enumerating objects: 22, done.
Counting objects: 100% (21/21), done.
Delta compression using up to 8 threads
Compressing objects: 100% (11/11), done.
Writing objects: 100% (11/11), 2.93 KiB | 2.93 MiB/s, done.
Total 11 (delta 7), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (7/7), completed with 4 local objects.
remote:
remote: Create a pull request for 'assignment5' on GitHub by visiting:
remote:      https://github.com/JamieBort/node-homework/pull/new/assignment5
remote:
remote: GitHub found 1 vulnerability on JamieBort/node-homework's default branch (1 high). To find out more, visit:
remote:      https://github.com/JamieBort/node-homework/security/dependabot/7
remote:
To github.com:JamieBort/node-homework.git
 * [new branch]      assignment5 -> assignment5
branch 'assignment5' set up to track 'origin/assignment5'.
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment5
Your branch is up to date with 'origin/assignment5'.

nothing to commit, working tree clean
zeus@MacBook-Air-de-Jamie node-homework % git switch assignment6
fatal: invalid reference: assignment6
zeus@MacBook-Air-de-Jamie node-homework % git switch -c assignment6
Switched to a new branch 'assignment6'
zeus@MacBook-Air-de-Jamie node-homework % git status
On branch assignment6
nothing to commit, working tree clean
zeus@MacBook-Air-de-Jamie node-homework % npm install prisma @prisma/client

added 24 packages, removed 1 package, changed 8 packages, and audited 575 packages in 41s

106 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
zeus@MacBook-Air-de-Jamie node-homework % npx prisma init
Fetching latest updates for this subcommand...

Initialized Prisma in your project

  prisma/
    schema.prisma
  prisma.config.ts

warn Prisma would have added DATABASE_URL but it already exists in .env
warn You already have a .gitignore file. Don't forget to add .env in it to not commit any private information.

Next, choose how you want to set up your database:
CONNECT EXISTING DATABASE:
  1. Configure your DATABASE_URL in prisma.config.ts
  2. Run prisma db pull to introspect your database.
CREATE NEW DATABASE:
  Local: npx prisma dev (runs Postgres locally in your terminal)
  Cloud: npx create-db (creates a free Prisma Postgres database)

Then, define your models in prisma/schema.prisma and run prisma migrate dev to apply your schema.
Learn more: https://pris.ly/getting-started


zeus@MacBook-Air-de-Jamie node-homework % rm prisma.config.ts
zeus@MacBook-Air-de-Jamie node-homework % npx prisma generate
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

✔ Generated Prisma Client (v6.19.2) to ./node_modules/@prisma/client in 139ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Interested in query caching in just a few lines of code? Try Accelerate today! https://pris.ly/tip-3-accelerate

zeus@MacBook-Air-de-Jamie node-homework % npx prisma db pull
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "tasklist", schema "public" at "localhost"

✔ Introspected 2 models and wrote them into prisma/schema.prisma in 229ms

Run prisma generate to generate Prisma Client.
┌─────────────────────────────────────────────────────────┐
│  Update available 6.19.2 -> 7.3.0                       │
│                                                         │
│  This is a major update - please follow the guide at    │
│  https://pris.ly/d/major-version-upgrade                │
│                                                         │
│  Run the following to update                            │
│    npm i --save-dev prisma@latest                       │
│    npm i @prisma/client@latest                          │
└─────────────────────────────────────────────────────────┘

node-homework % git status
On branch assignment6
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   .gitignore
        modified:   package-lock.json
        modified:   package.json

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        database-status.txt
        prisma/

no changes added to commit (use "git add" and/or "git commit -a")
zeus@MacBook-Air-de-Jamie node-homework % mv lesson6-notes.txt lesson6-notes.md
zeus@MacBook-Air-de-Jamie node-homework % brew services list
✔︎ JSON API formula_tap_migrations.jws.json                                                                                                                                              [Downloaded    1.9KB/  1.9KB]
✔︎ JSON API cask_tap_migrations.jws.json                                                                                                                                                 [Downloaded    2.4KB/  2.4KB]
✔︎ JSON API cask.jws.json                                                                                                                                                                [Downloaded   15.3MB/ 15.3MB]
✔︎ JSON API formula.jws.json                                                                                                                                                             [Downloaded   32.0MB/ 32.0MB]
Name          Status  User File
postgresql@14 started zeus ~/Library/LaunchAgents/homebrew.mxcl.postgresql@14.plist
zeus@MacBook-Air-de-Jamie node-homework % npx prisma migrate reset
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "tasklist", schema "public" at "localhost"

✔ Are you sure you want to reset your database? All data will be lost. … yes

Database reset successful


✔ Generated Prisma Client (v6.19.2) to ./node_modules/@prisma/client in 88ms

npm notice
npm notice New major version of npm available! 10.8.2 -> 11.9.0
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.9.0
npm notice To update run: npm install -g npm@11.9.0
npm notice
zeus@MacBook-Air-de-Jamie node-homework % npx prisma migrate dev --name firstMigration
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "tasklist", schema "public" at "localhost"

Applying migration `20260206214630_first_migration`

The following migration(s) have been created and applied from new schema changes:

prisma/migrations/
  └─ 20260206214630_first_migration/
    └─ migration.sql

Your database is now in sync with your schema.

✔ Generated Prisma Client (v6.19.2) to ./node_modules/@prisma/client in 90ms

┌─────────────────────────────────────────────────────────┐
│  Update available 6.19.2 -> 7.3.0                       │
│                                                         │
│  This is a major update - please follow the guide at    │
│  https://pris.ly/d/major-version-upgrade                │
│                                                         │
│  Run the following to update                            │
│    npm i --save-dev prisma@latest                       │
│    npm i @prisma/client@latest                          │
└─────────────────────────────────────────────────────────┘

zeus@MacBook-Air-de-Jamie node-homework % DATABASE_URL=postgresql://node_homework_owner@localhost/testtasklist?host=/tmp npx prisma migrate reset
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "testtasklist", schema "public" at "localhost"

✔ Are you sure you want to reset your database? All data will be lost. … yes

Applying migration `20260206214630_first_migration`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20260206214630_first_migration/
    └─ migration.sql

✔ Generated Prisma Client (v6.19.2) to ./node_modules/@prisma/client in 80ms

zeus@MacBook-Air-de-Jamie node-homework %