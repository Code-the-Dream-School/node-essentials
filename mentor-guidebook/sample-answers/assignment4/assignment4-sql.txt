SELECT o.order_id, SUM(price * quantity) total_price FROM orders o JOIN line_items l ON o.order_id = l.order_id JOIN products p ON l.product_id = p.product_id GROUP BY o.order_id ORDER BY o.order_id LIMIT 5;
SELECT customer_name, AVG(total_price) average_order_price FROM customers c JOIN (SELECT o.order_id, customer_id, SUM(price * quantity) total_price FROM orders o JOIN line_items l ON o.order_id = l.order_id JOIN products p ON l.product_id = p.product_id GROUP BY o.order_id) AS t ON c.customer_id = t.customer_id GROUP BY c.customer_id ORDER BY customer_name;
SELECT customer_id FROM customers WHERE customer_name = 'Perez and Sons';
SELECT employee_id FROM employees WHERE first_name = 'Miranda' AND last_name = 'Harris';
SELECT product_id FROM products ORDER BY price LIMIT 5;
BEGIN;
INSERT INTO orders (customer_id, employee_id, date) VALUES (16, 7, '2025-06-01') RETURNING order_id;
INSERT INTO line_items (order_id, product_id, quantity) VALUES(254, 23, 10),(254, 18, 10),(254, 43, 10),(254, 9, 10),(254, 44, 10);
COMMIT;
SELECT * FROM line_items WHERE order_id = 254;
SELECT first_name, last_name, COUNT(order_id) order_count FROM employees e JOIN orders o ON e.employee_id = o.employee_id GROUP BY e.employee_id HAVING COUNT(order_id) >= 5 ORDER BY MIN(last_name);